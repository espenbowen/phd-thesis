\subsection{Systematic uncertainties}
\label{sec:kpimm:systematics}

The main sources of systematic uncertainty for the differential branching fraction and the angular moments analysis are described in detail below and summarised in Table~\ref{tab:systematics}. The systematic uncertainties are significantly smaller than the statistical uncertainties.

\begin{table}[!tb]
\caption{Summary of the main sources of systematic uncertainty for the differential branching fraction and the angular moments analysis. Typical ranges are quoted for the different \qsq bins used in the differential branching fraction measurement and the different moments measured in the angular moments analysis.  The systematic uncertainties are significantly smaller than the statistical uncertainties.}
\label{tab:systematics}
\begin{center}
\begin{tabular}{r|cc}
Source & $d\BF/d\qsq \times 10^{-8}~[c^{4}/\gev^{2}]$ & $\overline{\Gamma}_{i}$ \\
\hline
Acceptance stat. uncertainty & 0.006$-$0.030 & 0.003$-$0.013 \\
Data-simulation differences & 0.001$-$0.014 & 0.001$-$0.007 \\
Peaking backgrounds & 0.013$-$0.026 & 0.001$-$0.040 \\
\hline
$\BF(\BdToJPsiKstP)$ & 0.033$-$0.110 & $-$ \\
\end{tabular}
\end{center}
\end{table} 

The differential branching fraction and angular moments analysis share several common systematic effects: the statistical uncertainty on the acceptance function due to the size of the simulated sample from which it is determined, differences between data candidates and the simulated candidates used for the determination of the acceptance function and contributions from residual peaking background candidates.  The differential branching fraction also has a systematic uncertainty due to the uncertainty on the branching fraction of the decay \BdToJPsiKstP. This is the dominant systematic uncertainty for the differential branching fraction and is shown separately in Table~\ref{tab:bf}. 

The size of the systematic uncertainties associated with the determination of the acceptance correction and residual peaking background contributions are evaluated using pseudo-experiments, where samples are generated varying one or more parameters.  The differential branching fraction and each of the moments are evaluated using both the nominal model and the systematically varied model. 
In general, the systematic uncertainty is then taken as the average of the difference between the two models over a large number of pseudo-experiments. The exception to this is the statistical uncertainty of the acceptance function. In order to account for this statistical variation, the standard deviation of the difference between the two models is used instead.

The effect of the statistical uncertainty on the acceptance function is evaluated using pseudoexperiments where candidates are generated with an acceptance that is varied according to the covariance matrix for the moments of the acceptance function. The effect of differences between the data candidates and the simulated candidates is evaluated using pseudoexperiments where candidates are generated with an acceptance determined from simulated candidates without applying the data-simulation corrections described in Sec.~\ref{sec:kpimm:data-mc}.

The effect of residual peaking background contributions is evaluated using pseudoexperiments where peaking background components are generated in addition to the signal and the combinatorial background.  The angular distributions of the peaking backgrounds are taken from data by isolating the decays using specific selections. In Appendix~\ref{sec:appendix:kernel}, the method is shown explicitly for the case of \BdToJPsiKpi decays with a $\pi\leftrightarrow\mu$ swap.

All other sources of systematic uncertainties investigated, such as the choice of the \mkpimm signal model and the resolution in the angular variables, are found to have a negligible impact.
